<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DEPARTMENT_OF_ETHEREAL_SAFETY // RECOVERY_88</title>
    <style>
        body, html { margin: 0; padding: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; color: #fff; cursor: none; }
        #canvas-container { position: relative; width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; }
        canvas { width: 100%; height: 100%; object-fit: contain; background: #050505; image-rendering: pixelated; }
        
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #status-bar { position: absolute; bottom: 20px; width: 80%; height: 5px; background: #222; display: none; }
        #progress { height: 100%; background: #f00; width: 0%; transition: width 0.1s; }
        
        .vhs-effect { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; 
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.05), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.05));
            background-size: 100% 3px, 3px 100%; opacity: 0.6; }

        button { padding: 20px 50px; border: 1px solid #555; background: transparent; color: #fff; letter-spacing: 5px; cursor: pointer; font-size: 1.2rem; }
        button:hover { background: #fff; color: #000; box-shadow: 0 0 20px #fff; }
    </style>
</head>
<body>

<div id="overlay">
    <h2 style="letter-spacing: 10px; opacity: 0.7;">PROJECT SEPHIROTH</h2>
    <p style="margin-bottom: 30px; font-size: 0.8rem; color: #555;">[ AUTHENTIC_SIGNAL_DECODING_MODE ]</p>
    <button id="startBtn">INITIATE BROADCAST</button>
    <div id="status-bar"><div id="progress"></div></div>
</div>

<div id="canvas-container">
    <canvas id="glitchCanvas"></canvas>
    <div class="vhs-effect"></div>
</div>

<script>
/**
 * SEPHIROTH_V6: THE_FIEND_DIRECTIVE
 * Professional Generative ARG Engine
 */

const canvas = document.getElementById('glitchCanvas');
const ctx = canvas.getContext('2d');
const startBtn = document.getElementById('startBtn');
const progress = document.getElementById('progress');

canvas.width = 1280;
canvas.height = 720;

let audioCtx, recorder, stream, audioDest;
let chunks = [];
let frame = 0;
let isRecording = false;
let currentTheme = null;
let scrapedImage = new Image();

const PSA_THEMES = [
    { title: "ATMOSPHERIC STABILITY", instruction: "REMAIN IN LOWER LEVELS", keywords: "overcast,industrial,void", voice: "Atmospheric stability is compromised. Remain in lower levels." },
    { title: "GEOGRAPHICAL DISPLACEMENT", instruction: "IGNORE NEW LANDMARKS", keywords: "forest,caves,ruins", voice: "Geographical displacement detected. Ignore all new landmarks." },
    { title: "COGNITIVE MAINTENANCE", instruction: "CEASE ALL REFLECTION", keywords: "eyes,anatomy,veins", voice: "Cognitive maintenance required. Cease all internal reflection." }
];

// --- AUDIO ARCHITECTURE ---
function setupAudio() {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    audioDest = audioCtx.createMediaStreamDestination();
    
    // Constant Unease Drone (40Hz)
    const drone = audioCtx.createOscillator();
    const droneGain = audioCtx.createGain();
    drone.type = 'sine';
    drone.frequency.setValueAtTime(40, audioCtx.currentTime);
    droneGain.gain.setValueAtTime(0.1, audioCtx.currentTime);
    drone.connect(droneGain).connect(audioDest);
    drone.connect(droneGain).connect(audioCtx.destination);
    drone.start();

    return audioDest.stream;
}

function playSting(freq, type = 'square', vol = 0.3) {
    const osc = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    osc.type = type;
    osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(10, audioCtx.currentTime + 0.5);
    g.gain.setValueAtTime(vol, audioCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.5);
    osc.connect(g).connect(audioDest);
    osc.connect(g).connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.6);
}

// --- VISUAL ARCHITECTURE ---
function drawTree(x, y, len, angle, branchWidth) {
    ctx.beginPath();
    ctx.save();
    ctx.strokeStyle = "rgba(255,255,255,0.4)";
    ctx.lineWidth = branchWidth;
    ctx.translate(x, y);
    ctx.rotate(angle * Math.PI / 180);
    ctx.moveTo(0, 0);
    ctx.lineTo(0, -len);
    ctx.stroke();

    if (len < 10) {
        ctx.restore();
        return;
    }

    drawTree(0, -len, len * 0.75, angle - 20, branchWidth * 0.7);
    drawTree(0, -len, len * 0.75, angle + 20, branchWidth * 0.7);
    ctx.restore();
}

function drawFiend() {
    const time = Date.now() * 0.002;
    ctx.save();
    ctx.translate(640 + Math.sin(time)*5, 360 + Math.cos(time)*5);
    
    // Mask Geometry
    ctx.fillStyle = "#111";
    ctx.strokeStyle = "#444";
    ctx.lineWidth = 4;
    
    // Outer Shield
    ctx.beginPath();
    ctx.moveTo(-180, -250); ctx.lineTo(180, -250); ctx.lineTo(200, 50); ctx.lineTo(0, 300); ctx.lineTo(-200, 50);
    ctx.closePath();
    ctx.fill(); ctx.stroke();

    // The Glowing Void Eyes
    const flicker = Math.random() > 0.95 ? 1 : 0.6;
    ctx.fillStyle = `rgba(255, 255, 255, ${flicker})`;
    ctx.shadowBlur = 30 * flicker;
    ctx.shadowColor = "white";
    ctx.fillRect(-90, -120, 50, 10);
    ctx.fillRect(40, -120, 50, 10);
    
    // Abstract "Tree of Life" etching on the forehead
    ctx.strokeStyle = "rgba(255,0,0,0.3)";
    drawTree(0, -150, 40, 0, 1);
    
    ctx.restore();
}

function render() {
    if (!isRecording) return;
    frame++;

    const progressPct = (frame / 2100) * 100; // 35 seconds
    progress.style.width = `${progressPct}%`;

    // Clear Screen
    ctx.fillStyle = "#000";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // PSA Phase Logic
    if (frame % 400 < 250) {
        // MUNDANE PSA MODE
        ctx.fillStyle = "#000033";
        ctx.fillRect(40, 40, 1200, 640);
        ctx.fillStyle = "#fff";
        ctx.font = "bold 40px 'Courier New'";
        ctx.fillText("D.E.S. BROADCAST // " + currentTheme.title, 80, 120);
        ctx.font = "24px 'Courier New'";
        ctx.fillText("STATUS: " + currentTheme.instruction, 80, 170);
        
        // Redacted Graph
        ctx.strokeStyle = "#555";
        ctx.beginPath();
        for(let i=0; i<10; i++) ctx.lineTo(100 + i*100, 500 - Math.random()*200);
        ctx.stroke();
        
        if (scrapedImage.complete) {
            ctx.globalAlpha = 0.5;
            ctx.drawImage(scrapedImage, 700, 250, 400, 300);
            ctx.globalAlpha = 1.0;
        }
    } else {
        // HORROR/ENTITY MODE
        if (Math.random() > 0.98) {
            playSting(Math.random()*200 + 50, 'sawtooth');
            ctx.fillStyle = "#f00";
            ctx.fillRect(0,0,1280,720);
        }
        drawFiend();
        
        // Random Text Scrape Subliminal
        ctx.fillStyle = "#fff";
        ctx.font = "15px monospace";
        ctx.fillText("0x" + Math.random().toString(16).slice(2, 10), Math.random()*1200, Math.random()*700);
    }

    // VHS Jitters
    if (Math.random() > 0.9) {
        ctx.drawImage(canvas, 2, 0, 1278, 720, 0, 0, 1280, 720);
    }

    if (frame >= 2100) {
        stopBroadcast();
    } else {
        requestAnimationFrame(render);
    }
}

// --- SYSTEM CONTROLS ---
function startBroadcast() {
    currentTheme = PSA_THEMES[Math.floor(Math.random() * PSA_THEMES.length)];
    scrapedImage.src = `https://picsum.photos/800/600?grayscale&blur=3&random=${Date.now()}`;
    
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('status-bar').style.display = 'block';
    
    const audioStream = setupAudio();
    const canvasStream = canvas.captureStream(60);
    
    // Muxing Audio and Video
    const combinedStream = new MediaStream([
        ...canvasStream.getVideoTracks(),
        ...audioStream.getAudioTracks()
    ]);

    recorder = new MediaRecorder(combinedStream, { mimeType: 'video/webm;codecs=vp9,opus' });
    recorder.ondataavailable = e => chunks.push(e.data);
    recorder.onstop = saveVideo;
    
    recorder.start();
    isRecording = true;
    render();

    // Voiceover
    const synth = window.speechSynthesis;
    const utter = new SpeechSynthesisUtterance(currentTheme.voice);
    utter.pitch = 0.1; utter.rate = 0.7; utter.lang = 'en-US';
    synth.speak(utter);
}

function stopBroadcast() {
    isRecording = false;
    recorder.stop();
}

function saveVideo() {
    const blob = new Blob(chunks, { type: 'video/webm' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `SEPHIROTH_DECODED_${Date.now()}.webm`;
    a.click();
    
    document.getElementById('overlay').style.display = 'flex';
    document.getElementById('overlay').innerHTML = "<h1>SIGNAL RECOVERED</h1><p>Check your downloads folder.</p>";
}

startBtn.addEventListener('click', () => {
    // Required to unlock AudioContext and Speech
    startBroadcast();
});

</script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DEPARTMENT_OF_ETHEREAL_SAFETY // RECOVERY_88</title>
    <style>
        body, html { margin: 0; padding: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; color: #fff; cursor: none; }
        #canvas-container { position: relative; width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; }
        canvas { width: 100%; height: 100%; object-fit: contain; background: #050505; image-rendering: pixelated; }
        
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #status-bar { position: absolute; bottom: 20px; width: 80%; height: 5px; background: #222; display: none; }
        #progress { height: 100%; background: #f00; width: 0%; transition: width 0.1s; }
        
        .vhs-effect { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; 
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.05), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.05));
            background-size: 100% 3px, 3px 100%; opacity: 0.6; }

        button { padding: 20px 50px; border: 1px solid #555; background: transparent; color: #fff; letter-spacing: 5px; cursor: pointer; font-size: 1.2rem; }
        button:hover { background: #fff; color: #000; box-shadow: 0 0 20px #fff; }
    </style>
</head>
<body>

<div id="overlay">
    <h2 style="letter-spacing: 10px; opacity: 0.7;">PROJECT SEPHIROTH</h2>
    <p style="margin-bottom: 30px; font-size: 0.8rem; color: #555;">[ AUTHENTIC_SIGNAL_DECODING_MODE ]</p>
    <button id="startBtn">INITIATE BROADCAST</button>
    <div id="status-bar"><div id="progress"></div></div>
</div>

<div id="canvas-container">
    <canvas id="glitchCanvas"></canvas>
    <div class="vhs-effect"></div>
</div>

<script>
/**
 * SEPHIROTH_V6: THE_FIEND_DIRECTIVE
 * Professional Generative ARG Engine
 */

const canvas = document.getElementById('glitchCanvas');
const ctx = canvas.getContext('2d');
const startBtn = document.getElementById('startBtn');
const progress = document.getElementById('progress');

canvas.width = 1280;
canvas.height = 720;

let audioCtx, recorder, stream, audioDest;
let chunks = [];
let frame = 0;
let isRecording = false;
let currentTheme = null;
let scrapedImage = new Image();

const PSA_THEMES = [
    { title: "ATMOSPHERIC STABILITY", instruction: "REMAIN IN LOWER LEVELS", keywords: "overcast,industrial,void", voice: "Atmospheric stability is compromised. Remain in lower levels." },
    { title: "GEOGRAPHICAL DISPLACEMENT", instruction: "IGNORE NEW LANDMARKS", keywords: "forest,caves,ruins", voice: "Geographical displacement detected. Ignore all new landmarks." },
    { title: "COGNITIVE MAINTENANCE", instruction: "CEASE ALL REFLECTION", keywords: "eyes,anatomy,veins", voice: "Cognitive maintenance required. Cease all internal reflection." }
];

// --- AUDIO ARCHITECTURE ---
function setupAudio() {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    audioDest = audioCtx.createMediaStreamDestination();
    
    // Constant Unease Drone (40Hz)
    const drone = audioCtx.createOscillator();
    const droneGain = audioCtx.createGain();
    drone.type = 'sine';
    drone.frequency.setValueAtTime(40, audioCtx.currentTime);
    droneGain.gain.setValueAtTime(0.1, audioCtx.currentTime);
    drone.connect(droneGain).connect(audioDest);
    drone.connect(droneGain).connect(audioCtx.destination);
    drone.start();

    return audioDest.stream;
}

function playSting(freq, type = 'square', vol = 0.3) {
    const osc = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    osc.type = type;
    osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(10, audioCtx.currentTime + 0.5);
    g.gain.setValueAtTime(vol, audioCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.5);
    osc.connect(g).connect(audioDest);
    osc.connect(g).connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.6);
}

// --- VISUAL ARCHITECTURE ---
function drawTree(x, y, len, angle, branchWidth) {
    ctx.beginPath();
    ctx.save();
    ctx.strokeStyle = "rgba(255,255,255,0.4)";
    ctx.lineWidth = branchWidth;
    ctx.translate(x, y);
    ctx.rotate(angle * Math.PI / 180);
    ctx.moveTo(0, 0);
    ctx.lineTo(0, -len);
    ctx.stroke();

    if (len < 10) {
        ctx.restore();
        return;
    }

    drawTree(0, -len, len * 0.75, angle - 20, branchWidth * 0.7);
    drawTree(0, -len, len * 0.75, angle + 20, branchWidth * 0.7);
    ctx.restore();
}

function drawFiend() {
    const time = Date.now() * 0.002;
    ctx.save();
    ctx.translate(640 + Math.sin(time)*5, 360 + Math.cos(time)*5);
    
    // Mask Geometry
    ctx.fillStyle = "#111";
    ctx.strokeStyle = "#444";
    ctx.lineWidth = 4;
    
    // Outer Shield
    ctx.beginPath();
    ctx.moveTo(-180, -250); ctx.lineTo(180, -250); ctx.lineTo(200, 50); ctx.lineTo(0, 300); ctx.lineTo(-200, 50);
    ctx.closePath();
    ctx.fill(); ctx.stroke();

    // The Glowing Void Eyes
    const flicker = Math.random() > 0.95 ? 1 : 0.6;
    ctx.fillStyle = `rgba(255, 255, 255, ${flicker})`;
    ctx.shadowBlur = 30 * flicker;
    ctx.shadowColor = "white";
    ctx.fillRect(-90, -120, 50, 10);
    ctx.fillRect(40, -120, 50, 10);
    
    // Abstract "Tree of Life" etching on the forehead
    ctx.strokeStyle = "rgba(255,0,0,0.3)";
    drawTree(0, -150, 40, 0, 1);
    
    ctx.restore();
}

function render() {
    if (!isRecording) return;
    frame++;

    const progressPct = (frame / 2100) * 100; // 35 seconds
    progress.style.width = `${progressPct}%`;

    // Clear Screen
    ctx.fillStyle = "#000";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // PSA Phase Logic
    if (frame % 400 < 250) {
        // MUNDANE PSA MODE
        ctx.fillStyle = "#000033";
        ctx.fillRect(40, 40, 1200, 640);
        ctx.fillStyle = "#fff";
        ctx.font = "bold 40px 'Courier New'";
        ctx.fillText("D.E.S. BROADCAST // " + currentTheme.title, 80, 120);
        ctx.font = "24px 'Courier New'";
        ctx.fillText("STATUS: " + currentTheme.instruction, 80, 170);
        
        // Redacted Graph
        ctx.strokeStyle = "#555";
        ctx.beginPath();
        for(let i=0; i<10; i++) ctx.lineTo(100 + i*100, 500 - Math.random()*200);
        ctx.stroke();
        
        if (scrapedImage.complete) {
            ctx.globalAlpha = 0.5;
            ctx.drawImage(scrapedImage, 700, 250, 400, 300);
            ctx.globalAlpha = 1.0;
        }
    } else {
        // HORROR/ENTITY MODE
        if (Math.random() > 0.98) {
            playSting(Math.random()*200 + 50, 'sawtooth');
            ctx.fillStyle = "#f00";
            ctx.fillRect(0,0,1280,720);
        }
        drawFiend();
        
        // Random Text Scrape Subliminal
        ctx.fillStyle = "#fff";
        ctx.font = "15px monospace";
        ctx.fillText("0x" + Math.random().toString(16).slice(2, 10), Math.random()*1200, Math.random()*700);
    }

    // VHS Jitters
    if (Math.random() > 0.9) {
        ctx.drawImage(canvas, 2, 0, 1278, 720, 0, 0, 1280, 720);
    }

    if (frame >= 2100) {
        stopBroadcast();
    } else {
        requestAnimationFrame(render);
    }
}

// --- SYSTEM CONTROLS ---
function startBroadcast() {
    currentTheme = PSA_THEMES[Math.floor(Math.random() * PSA_THEMES.length)];
    scrapedImage.src = `https://picsum.photos/800/600?grayscale&blur=3&random=${Date.now()}`;
    
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('status-bar').style.display = 'block';
    
    const audioStream = setupAudio();
    const canvasStream = canvas.captureStream(60);
    
    // Muxing Audio and Video
    const combinedStream = new MediaStream([
        ...canvasStream.getVideoTracks(),
        ...audioStream.getAudioTracks()
    ]);

    recorder = new MediaRecorder(combinedStream, { mimeType: 'video/webm;codecs=vp9,opus' });
    recorder.ondataavailable = e => chunks.push(e.data);
    recorder.onstop = saveVideo;
    
    recorder.start();
    isRecording = true;
    render();

    // Voiceover
    const synth = window.speechSynthesis;
    const utter = new SpeechSynthesisUtterance(currentTheme.voice);
    utter.pitch = 0.1; utter.rate = 0.7; utter.lang = 'en-US';
    synth.speak(utter);
}

function stopBroadcast() {
    isRecording = false;
    recorder.stop();
}

function saveVideo() {
    const blob = new Blob(chunks, { type: 'video/webm' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `SEPHIROTH_DECODED_${Date.now()}.webm`;
    a.click();
    
    document.getElementById('overlay').style.display = 'flex';
    document.getElementById('overlay').innerHTML = "<h1>SIGNAL RECOVERED</h1><p>Check your downloads folder.</p>";
}

startBtn.addEventListener('click', () => {
    // Required to unlock AudioContext and Speech
    startBroadcast();
});

</script>
</body>
</html>
